{"version":3,"file":"swipe.js","sourceRoot":"","sources":["../../../../../src/components/util/toast/swipe.ts"],"names":[],"mappings":"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","sourcesContent":["function isTouch(event: MouseEvent | TouchEvent): event is TouchEvent {\n  return window.TouchEvent && event instanceof TouchEvent;\n}\n\n\nexport class ToastSwipe {\n  anchor: {x: number, y: number} | undefined = undefined;\n  last: {x: number, y: number} | undefined = undefined;\n  direction: 'horizontal' | 'vertical' | undefined = undefined;\n\n  constructor(private container: HTMLElement, private remove: () => void) {\n    container.addEventListener('mousedown', event => this.start(event));\n    container.addEventListener('touchstart', event => this.start(event));\n    document.addEventListener('mousemove', event => this.move(event));\n    container.addEventListener('touchmove', event => this.move(event));\n    document.addEventListener('mouseup', () => this.release());\n    container.addEventListener('touchend', () => this.release());\n  }\n\n  getPos(event: MouseEvent | TouchEvent) {\n    if (isTouch(event)) {\n      return { x: event.touches[0].clientX, y: event.touches[0].clientY };\n    } else {\n      return { x : event.clientX, y: event.clientY };\n    }\n  }\n\n  start(event: MouseEvent | TouchEvent) {\n    this.anchor = this.getPos(event);\n    this.last = this.anchor;\n  }\n\n  move(event: MouseEvent | TouchEvent) {\n    if (this.anchor) {\n      event.stopPropagation();\n      event.preventDefault();\n      const pos = this.getPos(event);\n      this.last = pos;\n      const dx = pos.x - this.anchor.x;\n      const dy = pos.y - this.anchor.y;\n      if (!this.direction) {\n        if (Math.sqrt(dx * dx + dy * dy) > 16) {\n          if (Math.abs(dx) > Math.abs(dy)) {\n            this.direction = 'horizontal';\n          } else {\n            this.direction = 'vertical';\n          }\n        }\n      }\n\n      if (this.direction) {\n        this.container.classList.add('moving');\n        if (this.direction === 'horizontal') {\n          this.container.style.transform = `translateX(${dx}px)`;\n        } else {\n          this.container.style.transform = `translateY(${dy}px)`;\n        }\n      }\n    }\n  }\n\n  release() {\n    if (this.anchor && this.last) {\n      this.container.classList.remove('moving');\n\n      const dx = this.last.x - this.anchor.x;\n      const dy = this.last.y - this.anchor.y;\n      if (Math.sqrt(dx * dx + dy * dy) > 128) {\n        if (this.direction === 'horizontal') {\n          this.container.style.transform = `translateX(${2 * dx}px)`;\n        } else {\n          this.container.style.transform = `translateY(${2 * dy}px)`;\n        }\n        this.container.style.opacity = '0';\n        this.remove();\n      } else {\n        this.container.style.transform = '';\n      }\n\n      this.anchor = undefined;\n      this.last = undefined;\n      this.direction = undefined;\n    }\n  }\n\n  active() {\n    return this.anchor !== undefined;\n  }\n}\n"]}