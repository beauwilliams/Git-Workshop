{"version":3,"file":"gather-footnotes.js","sourceRoot":"","sources":["../../../../src/components/footnote/gather-footnotes.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,aAAa,EAAE,OAAO,EAAE,MAAM,yBAAyB,CAAC;AACjE,OAAO,EAAE,WAAW,EAAE,MAAM,0BAA0B,CAAC;AAGvD,MAAM,UAAU,eAAe;IAC7B,MAAM,QAAQ,GAAG,WAAW,EAAE,CAAC;IAE/B,OAAO,CAAC,GAAG,EAAE;QACX,MAAM,KAAK,GAAG,GAAG,EAAE;YACjB,IAAI,OAAO,GAAG,CAAC,CAAC;YAChB,IAAI,SAAS,GAAoC,EAAE,CAAC;YACpD,MAAM,UAAU,GAA2B,EAAE,CAAC;YAE9C,QAAQ,CAAC,gBAAgB,CAAC,mCAAmC,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;gBAC7E,IAAI,KAAK,CAAC,YAAY,CAAC,eAAe,CAAC,EAAE;oBACvC,MAAM,EAAE,GAAG,sBAAsB,KAAK,CAAC,YAAY,CAAC,kBAAkB,CAAC,IAAI,OAAO,EAAE,CAAC;oBACrF,MAAM,KAAK,GAAG,CAAC,EAAE,IAAI,UAAU,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,CAAC;oBACjF,IAAI,KAAK,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;wBAE/B,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;wBAC7B,KAAK,CAAC,YAAY,CAAC,qBAAqB,EAAE,GAAG,KAAK,EAAE,CAAC,CAAC;wBAEtD,SAAS,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC;qBACrC;oBAED,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,qBAAqB,CAAC,EAAE;wBAC9C,QAAQ,CAAC,MAAM,CAAC;4BACd,uBAAG,IAAI,EAAE,IAAI,EAAE,EAAE,EAAE,KAAK,EAAC,uBAAuB;gCAAC,2BAAI,KAAK,CAAK,CAAI,CAC/D,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;qBACvB;oBACD,KAAK,CAAC,MAAM,EAAE,CAAC;iBAChB;qBAAM;oBACL,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;wBACtD,QAAQ,CAAC,MAAM,CAAC;4BACd;gCAAM;oCAAG,2BAAI,CAAC,CAAC,KAAK,CAAK,CAAI,CAAO;;4BAAE,CAAC,CAAC,CAAC,CACrC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;oBACpB,CAAC,CAAC,CAAC;oBACH,SAAS,GAAG,EAAE,CAAC;iBAChB;YACH,CAAC,CAAC,CAAC;QACL,CAAC,CAAC;QAEF,KAAK,EAAE,CAAC;QAAC,MAAM,CAAC,gBAAgB,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;IACxD,CAAC,CAAC,CAAC;AACL,CAAC;AAED,MAAM,CAAC,MAAM,gBAAgB,GAAG,aAAa,CAAA,aAAa,CAAC,eAAe,CAAC,CAAC","sourcesContent":["import { funcTransport, onReady } from '@connectv/sdh/transport';\nimport { getRenderer } from '../../transport/renderer';\n\n\nexport function gatherFootnotes() {\n  const renderer = getRenderer();\n\n  onReady(() => {\n    const _exec = () => {\n      let counter = 1;\n      let collected: { index: number, $: Element }[] = [];\n      const countermap: {[id: string]: number} = {};\n\n      document.querySelectorAll('[data-footnote], [data-footnotes]').forEach(child => {\n        if (child.hasAttribute('data-footnote')) {\n          const id = `--codedoc-footnote-${child.getAttribute('data-footnote-id') || counter}`;\n          const index = (id in countermap) ? countermap[id] : (countermap[id] = counter++);\n          if (child.childNodes.length > 0) {\n            \n            child.setAttribute('id', id);\n            child.setAttribute('data-footnote-index', `${index}`);\n\n            collected.push({ index, $: child });\n          }\n\n          if (!child.hasAttribute('data-footnote-block')) {\n            renderer.render(<sup>\n              <a href={`#${id}`} style=\"text-decoration: none\"><b>{index}</b></a>\n            </sup>).before(child);\n          }\n          child.remove();\n        } else {\n          collected.sort((a, b) => a.index - b.index).forEach(_ => {\n            renderer.render(<div>\n              <span><a><b>{_.index}</b></a></span> {_.$}\n            </div>).on(child);\n          });\n          collected = [];\n        }\n      });\n    };\n\n    _exec(); window.addEventListener('navigation', _exec);\n  });\n}\n\nexport const gatherFootnotes$ = /*#__PURE__*/funcTransport(gatherFootnotes);"]}